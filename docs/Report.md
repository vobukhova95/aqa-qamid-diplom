# Отчет о тестировании формы оплаты тура по карте

| Параметр | Всего | API | UI  |
|----------|-------|-----|-----|
| Кол-во тест-кейсов | 126   | 67 | 59  |
| Успешно | 70    | 30 | 40  |
| Неуспешно | 56    | 37 | 19  |
| % успешных | 55%   | 45% | 68% |
| % неуспешных | 45%   | 55% | 32% |


## Краткое описание
Форма оплаты тура проверялась комплексно с использованием **UI и API тестирования**. Тестирование включало:
- **Функциональные проверки**: ввод валидных и невалидных данных карты, обязательные поля, формат, срок действия, CVC, имя держателя.
- **Проверки API**: прямые запросы к бэкенду, проверка корректности статусов, обработки ошибок и защиты от инъекций.
- **Проверки UI**: корректность отображения сообщений об ошибках, поведения формы при вводе невалидных данных, согласованность с результатами API.  


## Основные выявленные проблемы

### API
1. **Некорректные коды статуса:**
    - При отправке невалидных данных ожидался статус `400 Bad Request`, но API возвращало `500 Internal Server Error` или `200 OK`.
    - Примеры: пустые поля, неверный формат номера карты, CVC или даты.

2. **Проверка обязательных полей и формата:**
    - API не отрабатывает корректно ошибки при пустых полях: card number, CVC, month, year, holder.
    - Не проверяется минимальная и максимальная длина полей, наличие запрещённых символов.

3. **Валидация номера карты:**
    - Не отрабатываются проверки на длину номера, кириллицу, латиницу, специальные символы, пробелы в неправильных позициях.
    - Не отклоняются карты вида `0000 0000 0000 0000`.

4. **Валидация CVC и даты:**
    - Не отклоняются значения с неправильным количеством цифр, пробелами или пустые поля.
    - Месяц не проверяется на диапазон 01–12, прошлые месяцы.

5. **Валидация имени держателя:**
    - Не отклоняются имена с кириллицей, цифрами, спецсимволами, длиной более 50 или менее минимальной границы.
    - Отсутствует защита от SQL и XSS инъекций.

### UI
1. **Отсутствие корректной валидации на фронтенде:**
    - Поля принимают некорректные значения и отправляют их на банк вместо показа ошибки. Примеры: номер карты `0000 0000 0000 0000`, месяц `00`, предыдущий месяц текущего года.

2. **Сообщения об ошибках:**
    - Для обязательных полей вместо сообщения "Поле обязательно для заполнения" показывается "Неверный формат".
    - При отклонении карты банком отображается сообщение об успешной операции вместо сообщения об ошибке.

3. **Валидация имени держателя:**
    - Фронт принимает все значения: кириллица, цифры, спецсимволы, одна часть имени, длина больше 50.
    - Не происходит обрезки до 50 символов, отсутствует предупреждение о минимальной длине.

4. **Согласованность с API:**
    - UI не синхронизирован с логикой API, поэтому ошибки могут различаться между фронтом и бэком.

## Рекомендации
1. Исправить возвращаемые коды статуса на API (400 для невалидных данных).
2. Реализовать валидацию на фронтенде: формат карты, CVC, срок действия, holder.
3. Согласовать текст сообщений об ошибках между UI и API.
4. Ограничить длину и символы в поле holder; внедрить защиту от инъекций.
5. Обновить и синхронизировать тестовые сценарии между API и UI.